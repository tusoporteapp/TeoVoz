var h=(s,a)=>()=>(a||s((a={exports:{}}).exports,a),a.exports);var d=(s,a,l)=>new Promise((r,t)=>{var x=n=>{try{i(l.next(n))}catch(c){t(c)}},o=n=>{try{i(l.throw(n))}catch(c){t(c)}},i=n=>n.done?r(n.value):Promise.resolve(n.value).then(x,o);i((l=l.apply(s,a)).next())});import{u,j as e,C as p,a as f,R as b,b as j}from"./useBookRequests-rIJxXho-.js";var y=h(m=>{const N=()=>{const{requests:s,loading:a,markAsCompleted:l}=u(),r=t=>d(null,null,function*(){confirm(`¿Marcar "${t.bookName}" como completado? Esto notificará al usuario.`)&&(yield l(t.id,t.bookName),t.userToken?d(null,null,function*(){let o=localStorage.getItem("teovoz_fcm_server_key");if(o||(o=prompt('ADMIN: Para enviar notificación a la APP CERRADA, ingresa la "Server Key (Legacy)" de Firebase Console > Project Settings > Cloud Messaging. (Se guardará para la próxima).'),o&&localStorage.setItem("teovoz_fcm_server_key",o)),!!o)try{const i=yield fetch("https://fcm.googleapis.com/fcm/send",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`key=${o}`},body:JSON.stringify({to:t.userToken,notification:{title:"¡Libro Disponible!",body:`Tu pedido "${t.bookName}" ya está listo en TeoVoz.`,icon:"/Logo PNG.png",click_action:"/"}})});i.ok?alert("Push enviado con éxito."):alert("Error enviando Push: "+i.statusText)}catch(i){alert("Error de Red: "+i.message)}}):console.log("No token for user, skipping push."))});return a?e.jsx("div",{className:"p-10 text-white text-center",children:"Cargando solicitudes..."}):e.jsxs("div",{className:"min-h-screen bg-slate-900 text-white p-8 font-sans",children:[e.jsxs("header",{className:"max-w-4xl mx-auto mb-10 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/logo.svg",className:"w-10 h-10 rounded-xl"}),e.jsxs("h1",{className:"text-2xl font-black uppercase tracking-tight",children:["Admin ",e.jsx("span",{className:"text-indigo-500",children:"Solicitudes"})]})]}),e.jsxs("div",{className:"bg-slate-800 px-4 py-2 rounded-lg font-mono text-sm",children:[s.length," Totales"]})]}),e.jsxs("main",{className:"max-w-4xl mx-auto space-y-4",children:[s.length===0&&e.jsx("div",{className:"text-center py-20 text-slate-500",children:"No hay solicitudes pendientes."}),s.map(t=>e.jsxs("div",{className:`
                            relative p-6 rounded-2xl border flex items-center justify-between gap-6 transition-all
                            ${t.status==="completed"?"bg-slate-900/50 border-slate-800 opacity-60":"bg-slate-800 border-slate-700 shadow-xl"}
                        `,children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[t.status==="completed"?e.jsxs("span",{className:"bg-emerald-500/10 text-emerald-500 text-[10px] font-bold px-2 py-1 rounded-md uppercase tracking-wider flex items-center gap-1",children:[e.jsx(p,{size:10,strokeWidth:3})," Completado"]}):e.jsxs("span",{className:"bg-amber-500/10 text-amber-500 text-[10px] font-bold px-2 py-1 rounded-md uppercase tracking-wider flex items-center gap-1",children:[e.jsx(f,{size:10})," Pendiente"]}),e.jsx("span",{className:"text-slate-500 text-xs font-mono",children:new Date(t.timestamp).toLocaleDateString()})]}),e.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:t.bookName}),e.jsxs("p",{className:"text-slate-400 text-sm flex items-center gap-2",children:[e.jsx("span",{className:"text-indigo-400",children:"Autor:"})," ",t.author]})]}),t.status!=="completed"&&e.jsxs("button",{onClick:()=>r(t),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-5 py-3 rounded-xl font-bold text-sm shadow-lg shadow-indigo-600/20 active:scale-95 transition-all flex items-center gap-2",children:[e.jsx(p,{size:16}),"Marcar Listo"]})]},t.id))]})]})},g=document.getElementById("root");g&&b.createRoot(g).render(e.jsx(j.StrictMode,{children:e.jsx(N,{})}))});export default y();
