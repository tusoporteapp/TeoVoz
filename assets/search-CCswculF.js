import{r as d,j as e,e as E,E as y,b as N,R as j,d as v,a as w}from"./Skeleton-C4af2fp0.js";import{E as k}from"./EpisodeList-BdO2iNpA.js";import{C as T,f as z}from"./constants-BML1BJYv.js";import{S as C}from"./sparkles-B_M_yZlh.js";const f=n=>(n||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),b=(n,l)=>{const a=f(n),t=f(l);if(a.includes(t))return!0;if(t.length<4)return!1;let i=0,s=0;for(let c=0;c<t.length&&s<a.length;c++)t[c]!==a[s]&&(i++,t[c]===a[s+1]&&s++),s++;const m=t.length>6?2:1;return i<=m},M=({onEpisodeSelect:n,favorites:l,listened:a})=>{const[t,i]=d.useState(""),[s,m]=d.useState([]),[c,g]=d.useState(!1);d.useEffect(()=>{(async()=>{g(!0);try{const p=T.filter(r=>r.rss),S=(await Promise.all(p.map(r=>z(r.rss)))).flatMap(r=>r.episodes.map(u=>({...u,contentSnippet:`${u.contentSnippet||""}|||${r.title}`})));m(S.sort((r,u)=>new Date(u.pubDate).getTime()-new Date(r.pubDate).getTime()))}catch(p){console.error(p)}finally{g(!1)}})()},[]);const x=d.useMemo(()=>!t||t.length<2?s.slice(0,15):s.filter(o=>{const p=b(o.title,t),h=o.description&&b(o.description.substring(0,200),t);return p||h}).slice(0,50),[t,s]);return e.jsxs("div",{className:"animate-in fade-in duration-300 px-6",children:[e.jsx("div",{className:"sticky top-0 bg-app z-30 py-4 mb-6",children:e.jsxs("div",{className:"relative group",children:[e.jsx(E,{className:`absolute left-4 top-1/2 -translate-y-1/2 transition-colors ${t?"text-indigo-500":"text-muted"}`,size:20}),e.jsx("input",{type:"text",placeholder:"Libros, autores o temas...",value:t,onChange:o=>i(o.target.value),className:"w-full bg-surface border-app border rounded-2xl py-4 pl-12 pr-4 text-primary focus:outline-none focus:border-indigo-500 transition-all shadow-lg shadow-black/10 text-base"}),t&&e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 flex items-center gap-2",children:e.jsx("span",{className:"text-[8px] font-black text-indigo-500 uppercase tracking-widest bg-indigo-500/10 px-2 py-1 rounded-md animate-pulse",children:"BÃºsqueda Inteligente"})})]})}),c&&s.length===0?e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5,6].map(o=>e.jsx(y,{},o))}):e.jsxs("div",{className:"relative",children:[t&&x.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mb-4 px-2",children:[e.jsx(C,{size:12,className:"text-indigo-500"}),e.jsxs("p",{className:"text-[10px] font-black text-muted uppercase tracking-widest",children:["Resultados encontrados (",x.length,")"]})]}),e.jsx(k,{episodes:x,onPlay:n,favorites:l,listened:a,showPodcastTitle:!0,emptyMessage:t?`No encontramos nada parecido a "${t}". Prueba con otra palabra.`:"Cargando biblioteca..."})]})]})},L=()=>{const[n,l]=j.useState(null),a=new Set(JSON.parse(localStorage.getItem("teovoz_favorites")||"[]").map(i=>i.guid)),t=new Set(JSON.parse(localStorage.getItem("teovoz_listened")||"[]"));return e.jsx(v,{activeTab:"search",currentEpisode:n,onEpisodeChange:l,children:e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"p-6",children:e.jsx(w,{className:"h-40 rounded-3xl"})}),children:e.jsx(M,{onEpisodeSelect:l,favorites:a,listened:t})})})};N.createRoot(document.getElementById("root")).render(e.jsx(j.StrictMode,{children:e.jsx(L,{})}));
